<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>JLogin</title>
  <meta content="" name="description">
  <meta content="" name="keywords">
  
   <!-- Favicons -->
   <link href="{% static 'assets/img/favicon2.png' %}" rel="icon">
   <link href="{% static 'assets/img/search.png' %}" rel="apple-touch-icon">
  
  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cinzel">

  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
  
  <!-- Vendor CSS Files -->
  <link href="{% static 'assets/vendor/aos/aos.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/bootstrap-icons/bootstrap-icons.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/boxicons/css/boxicons.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/glightbox/css/glightbox.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/swiper/swiper-bundle.min.css' %}" rel="stylesheet">
  
  <!-- Template Main CSS File -->
  <link href="{% static 'assets/css/style.css' %}" rel="stylesheet">
  
  <!-- =======================================================
  * Template Name: JobMate
  * Updated: Sep 18 2023 with Bootstrap v5.3.2
  * Template URL: https://bootstrapmade.com/JobMate-free-onepage-bootstrap-theme/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
  <style>
    /* Increase button size on hover */
    .btn.btn-dark:hover {
        transform: scale(1.05);
    }

    /* Change button background color to green on hover */
    .btn.btn-dark:hover {
        background-color: #21cfaf; /* Green color with opacity */
        color: black;
        #btn
    {
      background-color: #007a6c;
    }

    #session {
      background-color: black;;
      color: white;
      padding: 10px 10px;
      margin-right: 10px;
      border-radius: 10px;
      transition: background-color 0.3s ease; /* Add transition for smooth hover effect */
  }

  #session:hover {
      background-color: #007a6c; /* Change background color on hover */
      color: white; /* Change text color on hover */
  
    }
    .sidebar {
      /* Your existing sidebar styles */
      /* Make sure to set an initial position for the sidebar */
      transform: translateX(-100%);
      transition: transform 0.3s ease;
    }
  
    .sidebar-open {
      transform: translateX(0);
    }
  
    .sidebar-toggle {
      /* Add styling for the hamburger menu icon */
    }
    .profile-box {
      border: 1px solid #ddd;
      padding: 20px;
      margin: 20px 0;
  }
  
  .profile-box h3 {
      margin-top: 0;
  }
    
</style>
</head>
<body>




  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top d-flex align-items-center">
    <div class="container d-flex justify-content-between">

      <div class="logo" id="badge">
        <h1 style="font-family: 'Cinzel', serif; color: white;" onmouseover="this.style.color='#21cfaf'" onmouseout="this.style.color='white'"> <a href="/"></a>JobMate</h1>

        <!-- Uncomment below if you prefer to use an image logo -->
        <!-- <a href="home.html"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->
      </div>

      <nav id="navbar" class="navbar">
        <ul>
            <li class="d-flex justify-content-center"> <!-- Add the justify-content-center class -->
                <form class="d-flex">
                    <input class="form-control me-2" type="search" placeholder="Search Jobs" aria-label="Search">
                    <div class="input-group-append">
                        <button class="btn btn-success" id="btn" type="button">Search</button>
                    </div> <!-- Close the div here -->
                </form>
            </li>

            <li><a class="nav-item" href="companydash">Home</a></li>
            <li><a class="nav-item" href="companyjobs">My Jobs</a></li>
            
            <li class="nav-item dropdown">
              <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">
                  <span id="session">
                    <img src="{{ provider.logo.url }}" class="rounded-circle" style="height: 30px; width: 30px; object-fit: cover; margin-right: 5px;">
                      {% if request.session.user_name %}
                          {{ request.session.user_name }}
                      
                      {% endif %}
                  </span>
              </a>
              <ul class="dropdown-menu dropdown-menu-right">
                <li class="text-center">
                    <img src="{{ provider.logo.url }}" class="rounded-circle" style="height: 120px; width: 120px; object-fit: cover; margin-bottom: 10px;">
                </li>
                <li><a href="providerpro"><i class="bi bi-pencil-square"></i> My Profile</a></li>
                <li><a href="changepw_pro"><i class="bi bi-shield-lock"></i> Change Password</a></li>
                <li><a href="logout"onclick="logout()"><i class="bi bi-box-arrow-right"></i> Sign Out</a></li>
                <script>
                  function logout() {
                    // Add your logout logic here, such as clearing session data
                    alert("You have been logged out.");
                  }
                </script>
            </ul>
        </li>
        <li><a class="nav-item" href="postjob">Post Job</a></li>
          
          
        

        
      
      
      </nav><!-- .navbar -->
    </div>
    </div>
  </header><!-- End Header -->

  <main id="main">
  <div id="app">
    <div class="main-wrapper">
      <div class="navbar-bg"></div>
      <nav class="navbar navbar-expand-lg main-navbar">
        <form class="form-inline mr-auto">
          <ul class="navbar-nav mr-3">
            <li><a href="#" data-toggle="sidebar" class="nav-link nav-link-lg"><i class="ion ion-navicon-round"></i></a></li>
            <li><a href="#" data-toggle="search" class="nav-link nav-link-lg d-sm-none"><i class="ion ion-search"></i></a></li>
          </ul>
          <div class="search-element">
            <input class="form-control" type="search" placeholder="Search" aria-label="Search">
            <button class="btn" type="submit"><i class="ion ion-search"></i></button>
          </div>
        </form>
        <ul class="navbar-nav navbar-right">
            <li class="dropdown dropdown-list-toggle">
                <a href="#" data-toggle="dropdown" class="nav-link notification-toggle nav-link-lg beep">
                    <i class="ion ion-ios-bell-outline"></i>
                </a>
                <div class="dropdown-menu dropdown-list dropdown-menu-right">
                    <!-- Add notifications here -->
                </div>
            </li>
            <li class="dropdown">
                <a href="#" data-toggle="dropdown" class="nav-link dropdown-toggle nav-link-lg">
                    <i class="ion ion-android-person d-lg-none"></i>
                    <div class="d-sm-none d-lg-inline-block">{{ user.username }}
                    <span id="more-details"><i class="ti-angle-down"></i></span> </div>
                </a>
                <div class="dropdown-menu dropdown-menu-right">
                    <ul>
                        <li class="more-details">
                            <a href="#"><i class="ti-user"></i>View Profile</a>
                            <a href="#!"><i class="ti-settings"></i>Settings</a>
                            <a href="/logout"><i class="ti-layout-sidebar-left"></i>Logout</a> <!-- Changed the logout link -->
                        </li>
                    </ul>
                </div>
            </li>
        </ul>
      </nav>

      <div class="main-content">
        <section class="section">
            <div class="container col-md-6">
                <h1>Edit Job: {{ job.title }}</h1>
                <form method="post" action="/edit_job/{{job.job_id}}"  onsubmit="return validateForm();">
                  {% csrf_token %}
            
                  <div class="form-group">
                    <label for="title">Title:</label>
                    <input type="text" class="form-control" id="title" name="title" value="{{ job.title }}" required onInput="validatetitle(this.value)">
                    <span id="title_error" class="title_error"></span>
                </div>
            
                  <div class="form-group">
                    <label for="type">Type:</label>
                    <select class="form-control" id="type" name="type">
                      <option value="Full-Time" {% if job.type == 'Full-Time' %}selected{% endif %}>Full-Time</option>
                      <option value="Part-Time" {% if job.type == 'Part-Time' %}selected{% endif %}>Part-Time</option>
                      <option value="Contract" {% if job.type == 'Contract' %}selected{% endif %}>Contract</option>
                    </select>
                  </div>
            
                  <div class="form-group">
                    <label for="location">Location:</label>
                    <input type="text" class="form-control" id="location" name="location" value="{{ job.location }}">
                  </div>
            
                  <div class="form-group">
                    <label for="status">Status:</label>
                    <input type="text" class="form-control" id="status" name="status" value="{{ job.status }}">
                  </div>
            
                  <div class="form-group">
                    <label for="deadline">Deadline:</label>
                    <input type="date" class="form-control" id="deadline" name="deadline" value="{{ job.deadline }}" onInput="validatedate(this.value)">
                    <span id="deadline_error" class="deadline_error"></span>
                </div>
            
                  <div class="form-group">
                    <label for="description">Description:</label>
                    <textarea class="form-control" id="description" onInput="validatedescription(this.value)" name="description" rows="4">{{ job.description }}</textarea>
                    <span id="description_error" class="description_error"></span>
                  </div>
            
                  <div class="form-group">
                    <label for="requirements">Requirements:</label>
                    <textarea class="form-control" id="requirements" class="form-control" required onInput="validaterequirements(this.value)" name="requirements" rows="4">{{ job.requirements }}</textarea>
                    <span id="requirements_error" class="requirements_error"></span>
                  </div>
            
                  <div class="form-group">
                    <label for="minexp">Minimum Experience:</label>
                    <input type="text" class="form-control" id="minexp" name="minexp" value="{{ job.minexp }}">
                  </div>
            
                  <div class="form-group">
                    <label for="min_salary">Minimum Salary:</label>
                    <input type="text" class="form-control" id="min_salary" name="min_salary" value="{{ job.min_salary }}">
                  </div>
            
                  <div class="form-group">
                    <label for="max_salary">Maximum Salary:</label>
                    <input type="text" class="form-control" id="max_salary" name="max_salary" value="{{ job.max_salary }}">
                  </div>
            
                  <div class="form-group">
                    <label for="mode">Mode:</label>
                    <select class="form-control" id="mode" name="mode">
                      <option value="Online" {% if job.mode == 'Online' %}selected{% endif %}>Online</option>
                      <option value="Offline" {% if job.mode == 'Offline' %}selected{% endif %}>Offline</option>
                      <option value="Both" {% if job.mode == 'Both' %}selected{% endif %}>Both</option>
                    </select>
                  </div>
                  <br>
                  <button type="submit" class="btn btn-dark -lg">Save Changes</button>
                  <a href="" class="btn btn-secondary">Cancel</a>
                </form>
              </div>
              <script>
                function validateForm() {
                    // Check if all required fields are filled and valid.
                    // Return true if the form is valid, or false if there are errors.
                    const dateValid = validatedate();
                    
                    const titleValid = validatetitle();
                    const expValid = validateexp();
                    const requirementsValid = validaterequirements();
                    const descriptionValid = validatedescription();
                    const skillsValid = validateSkills();
                    const resumeValid = validateFile('resume');
                    const proPicValid = validateFile('pro_pic');
                    const agreeChecked = document.getElementById('agree').checked;
            
                    // Check if all conditions are met
                    if (dateValid && titleValid && descriptionValid && requirementsValid && expValid && skillsValid && resumeValid && proPicValid){
                        if (!agreeChecked) {
                            alert('Please agree to the Terms of Service.');
                            return false;
                        } else {
                            alert('Thank you for agreeing to our Terms of Service.');
                            return true;
                        }
                    } else {
                        alert('Please fill in all required fields.');
                        return false;
                    }
                }
                function validatefname(input) {
                    const nameError = document.getElementById('fname_error');
                    const trimmedInput = input.trim();
                    let message = "";
                
                    if (trimmedInput === "") {
                        message = '<i class="bi bi-x-circle-fill text-danger"></i> Name is required.';
                    } else {
                        // Trim any trailing spaces from the input
                        const trimSpaces = trimmedInput.replace(/\s+$/, '');
                
                        if (!/^[A-Za-z\s.]*$/.test(trimSpaces)) {
                            if (/^[A-Za-z]/.test(trimSpaces)) {
                                message = '<i class="bi bi-x-circle-fill text-danger"></i> Name can only contain letters, spaces, and periods.';
                            } else {
                                message = '<i class="bi bi-x-circle-fill text-danger"></i> Name should start with a letter.';
                            }
                        } else if (/(?:\.\s*){2,}/.test(trimSpaces)) {
                            message = '<i class="bi bi-x-circle-fill text-danger"></i> Name should not contain consecutive periods.';
                        } else if (trimSpaces.split('.').length > 3) {
                            message = '<i class="bi bi-x-circle-fill text-danger"></i> Name can have a maximum of two periods.';
                        } else if (trimSpaces.length < 2) {
                            message = '<i class="bi bi-x-circle-fill text-danger"></i> Name must be at least 2 characters long.';
                        } else {
                            message = '<i class="bi bi-check-square-fill text-success mt-5"></i>';
                        }
                    }
                
                    nameError.style.color = message.includes('text-danger') ? 'red' : 'green';
                    nameError.innerHTML = message;
                }
                
                function validateSalaryRange() {
                    const minSalaryInput = document.getElementById('min_salary');
                    const maxSalaryInput = document.getElementById('max_salary');
                    const salaryRangeError = document.getElementById('salary_range_error');
                
                    const minSalary = parseFloat(minSalaryInput.value);
                    const maxSalary = parseFloat(maxSalaryInput.value);
                
                    let message = "";
                
                    // Check if both fields are filled
                    if (!isNaN(minSalary) && !isNaN(maxSalary)) {
                        // Check if values are between 0.5 and 50
                        if (minSalary < 0.5 || minSalary > 50 || maxSalary < 0.5 || maxSalary > 50) {
                            message = '<i class="bi bi-x-circle-fill text-danger"></i> Salary values should be between 0.5 and 50.';
                        } else if (minSalary > maxSalary) {
                            message = '<i class="bi bi-x-circle-fill text-danger"></i> Minimum salary should be less than or equal to maximum salary.';
                        } else {
                            message = '<i class="bi bi-check-square-fill text-success mt-5"></i>';
                        }
                    } else if (isNaN(minSalary) && isNaN(maxSalary)) {
                        // If both fields are empty, display a general error message
                        message = '<i class="bi bi-x-circle-fill text-danger"></i> Please enter valid salary values.';
                    } else {
                        // Display specific error message for the empty field
                        message = '<i class="bi bi-x-circle-fill text-danger"></i>';
                        message += isNaN(minSalary) ? ' Please enter minimum salary.' : ' Please enter maximum salary.';
                    }
                
                    // Display error message under both fields
                    salaryRangeError.innerHTML = message;
                    return message.includes('text-success');
                }
                
                function validatetitle() {
                  const title = document.getElementById('title').value;
                  const title_error = document.getElementById('title_error');
                  let message = "";
              
                  // Check for more than 4 consecutive special characters or digits
                  if (/(.*[\d!@#$%^&*()_+]){5,}/.test(title)) {
                      message = '<i class="bi bi-x-circle-fill text-danger"></i> Title should not contain more than 4 consecutive special characters or digits.';
                  } else if (title.length < 8) {
                      message = '<i class="bi bi-x-circle-fill text-danger"></i> Title should be at least 8 characters.';
                  } else if (!/[a-zA-Z]{4,}/.test(title)) {
                      message = '<i class="bi bi-x-circle-fill text-danger"></i> Title should contain at least 4 letters.';
                  } else if (/(.)\1{3,}/.test(title)) {
                      message = '<i class="bi bi-x-circle-fill text-danger"></i> Title should not have the same letter consecutively 4 times.';
                  } else {
                      message = '<i class="bi bi-check-square-fill text-success mt-5"></i>';
                  }
              
                  title_error.innerHTML = message;
                  return message.includes('text-success');
              }
              
              function validatedescription() {
                  const description = document.getElementById('description').value;
                  const description_error = document.getElementById('description_error');
                  let message = "";
              
                  // Check for more than 4 consecutive digits or special characters
                  if (/(.*[\d!@#$%^&*()_+]){5,}/.test(description)) {
                      message = '<i class="bi bi-x-circle-fill text-danger"></i> Description should not contain more than 4 consecutive digits or special characters.';
                  } else if (description.length < 15) {
                      message = '<i class="bi bi-x-circle-fill text-danger"></i> Description should be at least 15 characters.';
                  } else {
                      message = '<i class="bi bi-check-square-fill text-success mt-5"></i>';
                  }
              
                  description_error.innerHTML = message;
                  return message.includes('text-success');
              }
              
              function validaterequirements() {
                  const requirements = document.getElementById('requirements').value;
                  const requirements_error = document.getElementById('requirements_error');
                  let message = "";
              
                  // Check for more than 4 consecutive digits or special characters
                  if (/(.*[\d!@#$%^&*()_+]){5,}/.test(requirements)) {
                      message = '<i class="bi bi-x-circle-fill text-danger"></i> Requirements should not contain more than 4 consecutive digits or special characters.';
                  } else if (requirements.length < 15) {
                      message = '<i class="bi bi-x-circle-fill text-danger"></i> Requirements should be at least 15 characters.';
                  } else {
                      message = '<i class="bi bi-check-square-fill text-success mt-5"></i>';
                  }
              
                  requirements_error.innerHTML = message;
                  return message.includes('text-success');
              }
                </script>
            </div>
        </section>
        